using System;
using System.Linq;
using System.Text;

namespace Levenshtypo;

// The main `State` class was generated by Levenshtypo.Generator

internal class Distance2RestrictedEditLevenshtomaton<TCaseSensitivity> : Levenshtomaton where TCaseSensitivity : struct, ICaseSensitivity<TCaseSensitivity>
{
    private string _s;
    private Rune[] _sRune;

    public Distance2RestrictedEditLevenshtomaton(string s) : base(s, 2)
    {
        _s = s;
        _sRune = s.EnumerateRunes().ToArray();
    }

    public override bool IgnoreCase => typeof(TCaseSensitivity) == typeof(CaseInsensitive);

    public override LevenshtypoMetric Metric => LevenshtypoMetric.RestrictedEdit;

    public override T Execute<T>(ILevenshtomatonExecutor<T> executor) => executor.ExecuteAutomaton(StartSpecialized());

    public override bool Matches(ReadOnlySpan<char> text) => DefaultMatchesImplementation(text, StartSpecialized());

    private State StartSpecialized() => State.Start(_sRune);

    public override LevenshtomatonExecutionState Start() => LevenshtomatonExecutionState.FromStruct(StartSpecialized());

    private readonly struct State : ILevenshtomatonExecutionState<State>
    {
        private static ReadOnlySpan<short> TransitionsD0 => [0x0D, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0x03, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1];
        private static ReadOnlySpan<bool> FinalsD0 => [true, false, false, true, false, false, false, false, false, false, false, false, false, true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];
        private static ReadOnlySpan<short> TransitionsD1 => [0x01, 0x100, 0x04, 0x10D, -1, -1, -1, 0x103, -1, 0x103, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0x04, 0x10D, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1];
        private static ReadOnlySpan<bool> FinalsD1 => [true, true, false, false, true, false, false, false, false, false, false, false, false, true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];
        private static ReadOnlySpan<short> TransitionsD2 => [0x01, 0x1F, 0x100, 0x100, 0x02, 0x0B, 0x10D, 0x101, -1, 0x203, 0x103, 0x104, -1, -1, 0x103, 0x103, -1, 0x203, 0x103, 0x104, -1, -1, 0x103, 0x103, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0x203, 0x203, 0x104, 0x104, -1, 0x203, 0x104, 0x104, 0x04, 0x0C, 0x10D, 0x10D, 0x04, 0x0C, 0x10D, 0x10D, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0x02, 0x0B, 0x101, 0x101, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0x02, 0x0B, 0x10D, 0x101, -1, -1, -1, -1, 0x02, 0x0C, 0x10D, 0x10D, -1, -1, -1, -1, -1, -1, -1, -1];
        private static ReadOnlySpan<bool> FinalsD2 => [true, true, true, false, false, true, false, false, false, false, false, true, true, false, true, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, true, false, false, false, false, false, true, false, true, false, false];
        private static ReadOnlySpan<short> TransitionsD3 => [0x01, 0x10, 0x1F, 0x1F, 0x100, 0x100, 0x100, 0x100, 0x02, 0x06, 0x0B, 0x0B, 0x10D, 0x10E, 0x101, 0x101, -1, 0x303, 0x203, 0x204, 0x103, 0x105, 0x104, 0x102, -1, -1, -1, -1, 0x103, 0x103, 0x103, 0x103, -1, -1, 0x203, 0x203, 0x103, 0x103, 0x104, 0x104, -1, 0x303, -1, 0x303, 0x103, 0x105, 0x103, 0x105, -1, 0x303, 0x204, 0x204, 0x103, 0x105, 0x102, 0x102, -1, -1, -1, -1, 0x103, 0x103, 0x103, 0x103, -1, 0x303, -1, 0x303, 0x103, 0x105, 0x103, 0x105, -1, 0x303, 0x203, 0x204, 0x103, 0x105, 0x104, 0x102, -1, -1, 0x203, 0x203, 0x103, 0x103, 0x104, 0x104, 0x204, 0x30D, 0x204, 0x30D, 0x102, 0x10B, 0x102, 0x10B, -1, 0x303, 0x203, 0x204, 0x104, 0x102, 0x104, 0x102, 0x04, 0x04, 0x0C, 0x0C, 0x10D, 0x10D, 0x10D, 0x10D, 0x04, 0x0A, 0x0C, 0x0F, 0x10D, 0x10E, 0x10D, 0x10E, -1, 0x303, 0x203, 0x204, 0x104, 0x102, 0x104, 0x102, 0x02, 0x06, 0x0B, 0x0B, 0x10D, 0x10E, 0x101, 0x101, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0x04, 0x04, 0x0C, 0x0C, 0x10D, 0x10D, 0x10D, 0x10D, -1, -1, -1, -1, -1, -1, -1, -1, 0x04, 0x0A, 0x0C, 0x0F, 0x10D, 0x10E, 0x10D, 0x10E, -1, -1, -1, -1, -1, -1, -1, -1, 0x09, 0x21, 0x0B, 0x24, 0x101, 0x125, 0x101, 0x125, -1, -1, -1, -1, -1, -1, -1, -1, 0x303, 0x303, 0x204, 0x204, 0x105, 0x105, 0x102, 0x102, -1, -1, -1, -1, -1, -1, -1, -1, 0x303, 0x303, 0x303, 0x303, 0x105, 0x105, 0x105, 0x105, 0x204, 0x30D, 0x204, 0x30D, 0x102, 0x10B, 0x102, 0x10B, 0x09, 0x21, 0x0B, 0x24, 0x10E, 0x127, 0x101, 0x125, 0x04, 0x0A, 0x0F, 0x0F, 0x10D, 0x10E, 0x10E, 0x10E, 0x09, 0x21, 0x0F, 0x29, 0x10E, 0x127, 0x10E, 0x127, -1, -1, -1, -1, -1, -1, -1, -1, 0x303, 0x303, 0x204, 0x204, 0x102, 0x102, 0x102, 0x102];
        private static ReadOnlySpan<bool> FinalsD3 => [false, false, false, false, false, false, true, true, true, true, true, true, false, false, false, true, true, false, false, false, false, false, false, false, false, false, false, true, false, true, false, true, false, true, false, true, true, true, true, true, false, true];
        private static ReadOnlySpan<short> TransitionsD4 => [0x01, 0x01, 0x10, 0x10, 0x1F, 0x1F, 0x1F, 0x1F, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x02, 0x02, 0x06, 0x06, 0x0B, 0x0B, 0x0B, 0x0B, 0x10D, 0x10D, 0x10E, 0x10E, 0x101, 0x101, 0x101, 0x101, -1, -1, 0x303, 0x303, 0x203, 0x203, 0x204, 0x204, 0x103, 0x103, 0x105, 0x105, 0x104, 0x104, 0x102, 0x102, -1, -1, -1, -1, -1, -1, -1, -1, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, -1, -1, -1, -1, 0x203, 0x203, 0x203, 0x203, 0x103, 0x103, 0x103, 0x103, 0x104, 0x104, 0x104, 0x104, -1, -1, 0x303, 0x303, -1, -1, 0x303, 0x303, 0x103, 0x103, 0x105, 0x105, 0x103, 0x103, 0x105, 0x105, -1, 0x403, 0x303, 0x304, 0x204, 0x202, 0x204, 0x202, 0x103, 0x107, 0x105, 0x108, 0x102, 0x109, 0x102, 0x109, -1, 0x403, -1, 0x403, -1, 0x403, -1, 0x403, 0x103, 0x107, 0x103, 0x107, 0x103, 0x107, 0x103, 0x107, -1, 0x403, 0x303, 0x304, -1, 0x403, 0x303, 0x304, 0x103, 0x107, 0x105, 0x108, 0x103, 0x107, 0x105, 0x108, -1, 0x403, 0x303, 0x304, 0x203, 0x205, 0x204, 0x202, 0x103, 0x107, 0x105, 0x108, 0x104, 0x10A, 0x102, 0x109, -1, 0x403, -1, 0x403, 0x203, 0x205, 0x203, 0x205, 0x103, 0x107, 0x103, 0x107, 0x104, 0x10A, 0x104, 0x10A, 0x204, 0x20C, 0x30D, 0x30D, 0x204, 0x20C, 0x30D, 0x30D, 0x102, 0x106, 0x10B, 0x10B, 0x102, 0x106, 0x10B, 0x10B, -1, -1, 0x303, 0x303, 0x203, 0x203, 0x204, 0x204, 0x104, 0x104, 0x102, 0x102, 0x104, 0x104, 0x102, 0x102, 0x04, 0x04, 0x04, 0x04, 0x0C, 0x0C, 0x0C, 0x0C, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x04, 0x04, 0x0A, 0x0A, 0x0C, 0x0C, 0x0F, 0x0F, 0x10D, 0x10D, 0x10E, 0x10E, 0x10D, 0x10D, 0x10E, 0x10E, -1, 0x403, 0x303, 0x304, 0x203, 0x205, 0x204, 0x202, 0x104, 0x10A, 0x102, 0x109, 0x104, 0x10A, 0x102, 0x109, 0x02, 0x11, 0x06, 0x15, 0x0B, 0x1A, 0x0B, 0x1A, 0x10D, 0x11B, 0x10E, 0x11D, 0x101, 0x110, 0x101, 0x110, -1, -1, 0x303, 0x303, 0x203, 0x203, 0x204, 0x204, 0x103, 0x103, 0x105, 0x105, 0x104, 0x104, 0x102, 0x102, -1, -1, -1, -1, -1, -1, -1, -1, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, -1, -1, 0x303, 0x303, -1, -1, 0x303, 0x303, 0x103, 0x103, 0x105, 0x105, 0x103, 0x103, 0x105, 0x105, -1, -1, -1, -1, 0x203, 0x203, 0x203, 0x203, 0x103, 0x103, 0x103, 0x103, 0x104, 0x104, 0x104, 0x104, -1, 0x403, 0x303, 0x304, 0x204, 0x202, 0x204, 0x202, 0x103, 0x107, 0x105, 0x108, 0x102, 0x109, 0x102, 0x109, -1, 0x403, -1, 0x403, -1, 0x403, -1, 0x403, 0x103, 0x107, 0x103, 0x107, 0x103, 0x107, 0x103, 0x107, -1, 0x403, 0x303, 0x304, -1, 0x403, 0x303, 0x304, 0x103, 0x107, 0x105, 0x108, 0x103, 0x107, 0x105, 0x108, -1, 0x403, 0x303, 0x304, 0x203, 0x205, 0x204, 0x202, 0x103, 0x107, 0x105, 0x108, 0x104, 0x10A, 0x102, 0x109, -1, 0x403, -1, 0x403, 0x203, 0x205, 0x203, 0x205, 0x103, 0x107, 0x103, 0x107, 0x104, 0x10A, 0x104, 0x10A, 0x204, 0x20C, 0x30D, 0x30D, 0x204, 0x20C, 0x30D, 0x30D, 0x102, 0x106, 0x10B, 0x10B, 0x102, 0x106, 0x10B, 0x10B, 0x04, 0x14, 0x04, 0x14, 0x0C, 0x1C, 0x0C, 0x1C, 0x10D, 0x11B, 0x10D, 0x11B, 0x10D, 0x11B, 0x10D, 0x11B, -1, -1, 0x303, 0x303, 0x203, 0x203, 0x204, 0x204, 0x104, 0x104, 0x102, 0x102, 0x104, 0x104, 0x102, 0x102, 0x04, 0x14, 0x0A, 0x19, 0x0C, 0x1C, 0x0F, 0x1E, 0x10D, 0x11B, 0x10E, 0x11D, 0x10D, 0x11B, 0x10E, 0x11D, -1, 0x403, 0x303, 0x304, 0x203, 0x205, 0x204, 0x202, 0x104, 0x10A, 0x102, 0x109, 0x104, 0x10A, 0x102, 0x109, 0x09, 0x20, 0x21, 0x21, 0x0B, 0x1A, 0x24, 0x24, 0x101, 0x110, 0x125, 0x125, 0x101, 0x110, 0x125, 0x125, -1, 0x403, 0x304, 0x304, 0x203, 0x205, 0x202, 0x202, 0x103, 0x107, 0x108, 0x108, 0x104, 0x10A, 0x109, 0x109, 0x304, 0x40D, 0x304, 0x40D, 0x202, 0x20B, 0x202, 0x20B, 0x108, 0x123, 0x108, 0x123, 0x109, 0x121, 0x109, 0x121, -1, 0x403, 0x304, 0x304, -1, 0x403, 0x304, 0x304, 0x103, 0x107, 0x108, 0x108, 0x103, 0x107, 0x108, 0x108, 0x304, 0x40D, 0x304, 0x40D, 0x304, 0x40D, 0x304, 0x40D, 0x108, 0x123, 0x108, 0x123, 0x108, 0x123, 0x108, 0x123, 0x202, 0x20B, 0x30D, 0x301, 0x202, 0x20B, 0x30D, 0x301, 0x109, 0x121, 0x10B, 0x124, 0x109, 0x121, 0x10B, 0x124, 0x09, 0x20, 0x21, 0x21, 0x0B, 0x1A, 0x24, 0x24, 0x10E, 0x126, 0x127, 0x127, 0x101, 0x110, 0x125, 0x125, 0x04, 0x14, 0x0A, 0x19, 0x0F, 0x1E, 0x0F, 0x1E, 0x10D, 0x11B, 0x10E, 0x11D, 0x10E, 0x11D, 0x10E, 0x11D, 0x09, 0x20, 0x21, 0x21, 0x0F, 0x28, 0x29, 0x29, 0x10E, 0x126, 0x127, 0x127, 0x10E, 0x126, 0x127, 0x127, -1, 0x403, 0x304, 0x304, 0x203, 0x205, 0x202, 0x202, 0x104, 0x10A, 0x109, 0x109, 0x104, 0x10A, 0x109, 0x109, 0x304, 0x40D, 0x304, 0x40D, 0x202, 0x20B, 0x202, 0x20B, 0x109, 0x121, 0x109, 0x121, 0x109, 0x121, 0x109, 0x121];
        private static ReadOnlySpan<bool> FinalsD4 => [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, true, true, true, true, true, true, true, true, true, true, false, true, false, true, false, true, true, true, true, true, false, false, false, true, true];
        private static ReadOnlySpan<short> TransitionsD5 => [0x01, 0x01, 0x01, 0x01, 0x10, 0x10, 0x10, 0x10, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x1F, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x100, 0x02, 0x02, 0x02, 0x02, 0x06, 0x06, 0x06, 0x06, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x0B, 0x10D, 0x10D, 0x10D, 0x10D, 0x10E, 0x10E, 0x10E, 0x10E, 0x101, 0x101, 0x101, 0x101, 0x101, 0x101, 0x101, 0x101, -1, -1, -1, -1, 0x303, 0x303, 0x303, 0x303, 0x203, 0x203, 0x203, 0x203, 0x204, 0x204, 0x204, 0x204, 0x103, 0x103, 0x103, 0x103, 0x105, 0x105, 0x105, 0x105, 0x104, 0x104, 0x104, 0x104, 0x102, 0x102, 0x102, 0x102, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, -1, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, -1, -1, -1, -1, -1, -1, -1, -1, 0x203, 0x203, 0x203, 0x203, 0x203, 0x203, 0x203, 0x203, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x103, 0x104, 0x104, 0x104, 0x104, 0x104, 0x104, 0x104, 0x104, -1, -1, -1, -1, 0x303, 0x303, 0x303, 0x303, -1, -1, -1, -1, 0x303, 0x303, 0x303, 0x303, 0x103, 0x103, 0x103, 0x103, 0x105, 0x105, 0x105, 0x105, 0x103, 0x103, 0x103, 0x103, 0x105, 0x105, 0x105, 0x105, -1, -1, 0x403, 0x403, 0x303, 0x303, 0x304, 0x304, 0x204, 0x204, 0x202, 0x202, 0x204, 0x204, 0x202, 0x202, 0x103, 0x103, 0x107, 0x107, 0x105, 0x105, 0x108, 0x108, 0x102, 0x102, 0x109, 0x109, 0x102, 0x102, 0x109, 0x109, -1, -1, 0x403, 0x403, -1, -1, 0x403, 0x403, -1, -1, 0x403, 0x403, -1, -1, 0x403, 0x403, 0x103, 0x103, 0x107, 0x107, 0x103, 0x103, 0x107, 0x107, 0x103, 0x103, 0x107, 0x107, 0x103, 0x103, 0x107, 0x107, -1, -1, 0x403, 0x403, 0x303, 0x303, 0x304, 0x304, -1, -1, 0x403, 0x403, 0x303, 0x303, 0x304, 0x304, 0x103, 0x103, 0x107, 0x107, 0x105, 0x105, 0x108, 0x108, 0x103, 0x103, 0x107, 0x107, 0x105, 0x105, 0x108, 0x108, -1, -1, 0x403, 0x403, 0x303, 0x303, 0x304, 0x304, 0x203, 0x203, 0x205, 0x205, 0x204, 0x204, 0x202, 0x202, 0x103, 0x103, 0x107, 0x107, 0x105, 0x105, 0x108, 0x108, 0x104, 0x104, 0x10A, 0x10A, 0x102, 0x102, 0x109, 0x109, -1, -1, 0x403, 0x403, -1, -1, 0x403, 0x403, 0x203, 0x203, 0x205, 0x205, 0x203, 0x203, 0x205, 0x205, 0x103, 0x103, 0x107, 0x107, 0x103, 0x103, 0x107, 0x107, 0x104, 0x104, 0x10A, 0x10A, 0x104, 0x104, 0x10A, 0x10A, 0x204, 0x204, 0x20C, 0x20C, 0x30D, 0x30D, 0x30D, 0x30D, 0x204, 0x204, 0x20C, 0x20C, 0x30D, 0x30D, 0x30D, 0x30D, 0x102, 0x102, 0x106, 0x106, 0x10B, 0x10B, 0x10B, 0x10B, 0x102, 0x102, 0x106, 0x106, 0x10B, 0x10B, 0x10B, 0x10B, -1, -1, -1, -1, 0x303, 0x303, 0x303, 0x303, 0x203, 0x203, 0x203, 0x203, 0x204, 0x204, 0x204, 0x204, 0x104, 0x104, 0x104, 0x104, 0x102, 0x102, 0x102, 0x102, 0x104, 0x104, 0x104, 0x104, 0x102, 0x102, 0x102, 0x102, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x04, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x0C, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x10D, 0x04, 0x04, 0x04, 0x04, 0x0A, 0x0A, 0x0A, 0x0A, 0x0C, 0x0C, 0x0C, 0x0C, 0x0F, 0x0F, 0x0F, 0x0F, 0x10D, 0x10D, 0x10D, 0x10D, 0x10E, 0x10E, 0x10E, 0x10E, 0x10D, 0x10D, 0x10D, 0x10D, 0x10E, 0x10E, 0x10E, 0x10E, -1, -1, 0x403, 0x403, 0x303, 0x303, 0x304, 0x304, 0x203, 0x203, 0x205, 0x205, 0x204, 0x204, 0x202, 0x202, 0x104, 0x104, 0x10A, 0x10A, 0x102, 0x102, 0x109, 0x109, 0x104, 0x104, 0x10A, 0x10A, 0x102, 0x102, 0x109, 0x109, 0x02, 0x02, 0x11, 0x11, 0x06, 0x06, 0x15, 0x15, 0x0B, 0x0B, 0x1A, 0x1A, 0x0B, 0x0B, 0x1A, 0x1A, 0x10D, 0x10D, 0x11B, 0x11B, 0x10E, 0x10E, 0x11D, 0x11D, 0x101, 0x101, 0x110, 0x110, 0x101, 0x101, 0x110, 0x110, -1, 0x503, -1, 0x503, 0x303, 0x305, 0x303, 0x305, 0x203, 0x207, 0x203, 0x207, 0x204, 0x20A, 0x204, 0x20A, 0x103, 0x112, 0x103, 0x112, 0x105, 0x113, 0x105, 0x113, 0x104, 0x114, 0x104, 0x114, 0x102, 0x111, 0x102, 0x111, -1, 0x503, -1, 0x503, -1, 0x503, -1, 0x503, -1, 0x503, -1, 0x503, -1, 0x503, -1, 0x503, 0x103, 0x112, 0x103, 0x112, 0x103, 0x112, 0x103, 0x112, 0x103, 0x112, 0x103, 0x112, 0x103, 0x112, 0x103, 0x112, -1, 0x503, -1, 0x503, 0x303, 0x305, 0x303, 0x305, -1, 0x503, -1, 0x503, 0x303, 0x305, 0x303, 0x305, 0x103, 0x112, 0x103, 0x112, 0x105, 0x113, 0x105, 0x113, 0x103, 0x112, 0x103, 0x112, 0x105, 0x113, 0x105, 0x113, -1, 0x503, -1, 0x503, -1, 0x503, -1, 0x503, 0x203, 0x207, 0x203, 0x207, 0x203, 0x207, 0x203, 0x207, 0x103, 0x112, 0x103, 0x112, 0x103, 0x112, 0x103, 0x112, 0x104, 0x114, 0x104, 0x114, 0x104, 0x114, 0x104, 0x114, -1, 0x503, 0x403, 0x404, 0x303, 0x305, 0x304, 0x302, 0x204, 0x20A, 0x202, 0x209, 0x204, 0x20A, 0x202, 0x209, 0x103, 0x112, 0x107, 0x116, 0x105, 0x113, 0x108, 0x117, 0x102, 0x111, 0x109, 0x118, 0x102, 0x111, 0x109, 0x118, -1, 0x503, 0x403, 0x404, -1, 0x503, 0x403, 0x404, -1, 0x503, 0x403, 0x404, -1, 0x503, 0x403, 0x404, 0x103, 0x112, 0x107, 0x116, 0x103, 0x112, 0x107, 0x116, 0x103, 0x112, 0x107, 0x116, 0x103, 0x112, 0x107, 0x116, -1, 0x503, 0x403, 0x404, 0x303, 0x305, 0x304, 0x302, -1, 0x503, 0x403, 0x404, 0x303, 0x305, 0x304, 0x302, 0x103, 0x112, 0x107, 0x116, 0x105, 0x113, 0x108, 0x117, 0x103, 0x112, 0x107, 0x116, 0x105, 0x113, 0x108, 0x117, -1, 0x503, 0x403, 0x404, 0x303, 0x305, 0x304, 0x302, 0x203, 0x207, 0x205, 0x208, 0x204, 0x20A, 0x202, 0x209, 0x103, 0x112, 0x107, 0x116, 0x105, 0x113, 0x108, 0x117, 0x104, 0x114, 0x10A, 0x119, 0x102, 0x111, 0x109, 0x118, -1, 0x503, 0x403, 0x404, -1, 0x503, 0x403, 0x404, 0x203, 0x207, 0x205, 0x208, 0x203, 0x207, 0x205, 0x208, 0x103, 0x112, 0x107, 0x116, 0x103, 0x112, 0x107, 0x116, 0x104, 0x114, 0x10A, 0x119, 0x104, 0x114, 0x10A, 0x119, 0x204, 0x20A, 0x20C, 0x20F, 0x30D, 0x30E, 0x30D, 0x30E, 0x204, 0x20A, 0x20C, 0x20F, 0x30D, 0x30E, 0x30D, 0x30E, 0x102, 0x111, 0x106, 0x115, 0x10B, 0x11A, 0x10B, 0x11A, 0x102, 0x111, 0x106, 0x115, 0x10B, 0x11A, 0x10B, 0x11A, 0x04, 0x04, 0x14, 0x14, 0x04, 0x04, 0x14, 0x14, 0x0C, 0x0C, 0x1C, 0x1C, 0x0C, 0x0C, 0x1C, 0x1C, 0x10D, 0x10D, 0x11B, 0x11B, 0x10D, 0x10D, 0x11B, 0x11B, 0x10D, 0x10D, 0x11B, 0x11B, 0x10D, 0x10D, 0x11B, 0x11B, -1, 0x503, -1, 0x503, 0x303, 0x305, 0x303, 0x305, 0x203, 0x207, 0x203, 0x207, 0x204, 0x20A, 0x204, 0x20A, 0x104, 0x114, 0x104, 0x114, 0x102, 0x111, 0x102, 0x111, 0x104, 0x114, 0x104, 0x114, 0x102, 0x111, 0x102, 0x111, 0x04, 0x04, 0x14, 0x14, 0x0A, 0x0A, 0x19, 0x19, 0x0C, 0x0C, 0x1C, 0x1C, 0x0F, 0x0F, 0x1E, 0x1E, 0x10D, 0x10D, 0x11B, 0x11B, 0x10E, 0x10E, 0x11D, 0x11D, 0x10D, 0x10D, 0x11B, 0x11B, 0x10E, 0x10E, 0x11D, 0x11D, -1, 0x503, 0x403, 0x404, 0x303, 0x305, 0x304, 0x302, 0x203, 0x207, 0x205, 0x208, 0x204, 0x20A, 0x202, 0x209, 0x104, 0x114, 0x10A, 0x119, 0x102, 0x111, 0x109, 0x118, 0x104, 0x114, 0x10A, 0x119, 0x102, 0x111, 0x109, 0x118, 0x09, 0x09, 0x20, 0x20, 0x21, 0x21, 0x21, 0x21, 0x0B, 0x0B, 0x1A, 0x1A, 0x24, 0x24, 0x24, 0x24, 0x101, 0x101, 0x110, 0x110, 0x125, 0x125, 0x125, 0x125, 0x101, 0x101, 0x110, 0x110, 0x125, 0x125, 0x125, 0x125, -1, 0x503, 0x403, 0x404, 0x304, 0x302, 0x304, 0x302, 0x203, 0x207, 0x205, 0x208, 0x202, 0x209, 0x202, 0x209, 0x103, 0x112, 0x107, 0x116, 0x108, 0x117, 0x108, 0x117, 0x104, 0x114, 0x10A, 0x119, 0x109, 0x118, 0x109, 0x118, 0x304, 0x30C, 0x40D, 0x40D, 0x304, 0x30C, 0x40D, 0x40D, 0x202, 0x206, 0x20B, 0x20B, 0x202, 0x206, 0x20B, 0x20B, 0x108, 0x122, 0x123, 0x123, 0x108, 0x122, 0x123, 0x123, 0x109, 0x120, 0x121, 0x121, 0x109, 0x120, 0x121, 0x121, -1, 0x503, 0x403, 0x404, 0x304, 0x302, 0x304, 0x302, -1, 0x503, 0x403, 0x404, 0x304, 0x302, 0x304, 0x302, 0x103, 0x112, 0x107, 0x116, 0x108, 0x117, 0x108, 0x117, 0x103, 0x112, 0x107, 0x116, 0x108, 0x117, 0x108, 0x117, 0x304, 0x30C, 0x40D, 0x40D, 0x304, 0x30C, 0x40D, 0x40D, 0x304, 0x30C, 0x40D, 0x40D, 0x304, 0x30C, 0x40D, 0x40D, 0x108, 0x122, 0x123, 0x123, 0x108, 0x122, 0x123, 0x123, 0x108, 0x122, 0x123, 0x123, 0x108, 0x122, 0x123, 0x123, 0x202, 0x206, 0x20B, 0x20B, 0x30D, 0x30E, 0x301, 0x301, 0x202, 0x206, 0x20B, 0x20B, 0x30D, 0x30E, 0x301, 0x301, 0x109, 0x120, 0x121, 0x121, 0x10B, 0x11A, 0x124, 0x124, 0x109, 0x120, 0x121, 0x121, 0x10B, 0x11A, 0x124, 0x124, 0x09, 0x09, 0x20, 0x20, 0x21, 0x21, 0x21, 0x21, 0x0B, 0x0B, 0x1A, 0x1A, 0x24, 0x24, 0x24, 0x24, 0x10E, 0x10E, 0x126, 0x126, 0x127, 0x127, 0x127, 0x127, 0x101, 0x101, 0x110, 0x110, 0x125, 0x125, 0x125, 0x125, 0x04, 0x04, 0x14, 0x14, 0x0A, 0x0A, 0x19, 0x19, 0x0F, 0x0F, 0x1E, 0x1E, 0x0F, 0x0F, 0x1E, 0x1E, 0x10D, 0x10D, 0x11B, 0x11B, 0x10E, 0x10E, 0x11D, 0x11D, 0x10E, 0x10E, 0x11D, 0x11D, 0x10E, 0x10E, 0x11D, 0x11D, 0x09, 0x09, 0x20, 0x20, 0x21, 0x21, 0x21, 0x21, 0x0F, 0x0F, 0x28, 0x28, 0x29, 0x29, 0x29, 0x29, 0x10E, 0x10E, 0x126, 0x126, 0x127, 0x127, 0x127, 0x127, 0x10E, 0x10E, 0x126, 0x126, 0x127, 0x127, 0x127, 0x127, -1, 0x503, 0x403, 0x404, 0x304, 0x302, 0x304, 0x302, 0x203, 0x207, 0x205, 0x208, 0x202, 0x209, 0x202, 0x209, 0x104, 0x114, 0x10A, 0x119, 0x109, 0x118, 0x109, 0x118, 0x104, 0x114, 0x10A, 0x119, 0x109, 0x118, 0x109, 0x118, 0x304, 0x30C, 0x40D, 0x40D, 0x304, 0x30C, 0x40D, 0x40D, 0x202, 0x206, 0x20B, 0x20B, 0x202, 0x206, 0x20B, 0x20B, 0x109, 0x120, 0x121, 0x121, 0x109, 0x120, 0x121, 0x121, 0x109, 0x120, 0x121, 0x121, 0x109, 0x120, 0x121, 0x121];
        private static ReadOnlySpan<bool> FinalsD5 => [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];

        private readonly Rune[] _sRune;
        private readonly int _sIndex;
        private readonly int _state;

        private State(Rune[] sRune, int state, int sIndex)
        {
            _sRune = sRune;
            _state = state;
            _sIndex = sIndex;
        }

        internal static State Start(Rune[] sRune) => new State(sRune, 0, 0);

        public bool MoveNext(Rune c, out State next)
        {
            var s = _sRune;
            var sIndex = _sIndex;

            short encodedNext;

            switch (s.Length - sIndex)
            {
                case 0:
                    {
                        var vector = 0
                            ;

                        encodedNext = TransitionsD0[_state * 1 + vector];

                        break;
                    }
                case 1:
                    {
                        var vector = 0
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 0]) ? 1 : 0)
                            ;

                        encodedNext = TransitionsD1[_state * 2 + vector];

                        break;
                    }
                case 2:
                    {
                        var vector = 0
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 0]) ? 2 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 1]) ? 1 : 0)
                            ;

                        encodedNext = TransitionsD2[_state * 4 + vector];

                        break;
                    }
                case 3:
                    {
                        var vector = 0
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 0]) ? 4 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 1]) ? 2 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 2]) ? 1 : 0)
                            ;

                        encodedNext = TransitionsD3[_state * 8 + vector];

                        break;
                    }
                case 4:
                    {
                        var vector = 0
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 0]) ? 8 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 1]) ? 4 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 2]) ? 2 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 3]) ? 1 : 0)
                            ;

                        encodedNext = TransitionsD4[_state * 16 + vector];

                        break;
                    }
                default:
                    {
                        var vector = 0
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 0]) ? 16 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 1]) ? 8 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 2]) ? 4 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 3]) ? 2 : 0)
                            | (default(TCaseSensitivity).Equals(c, s[sIndex + 4]) ? 1 : 0)
                            ;

                        encodedNext = TransitionsD5[_state * 32 + vector];

                        break;
                    }
            }

            if (encodedNext >= 0)
            {
                // format:
                // top bit reserved for negative sign
                // next 7 bits reserved for offset (max = 64 is more than enough)
                // next 8 bits is the nextState
                int nextState = encodedNext & 0xFF;
                int offset = (encodedNext >> 8) & 0x3F;
                next = new State(_sRune, nextState, sIndex + offset);
                return true;
            }

            next = default;
            return false;
        }

        public bool IsFinal =>
            (_sRune.Length - _sIndex) switch
            {
                0 => FinalsD0[_state],
                1 => FinalsD1[_state],
                2 => FinalsD2[_state],
                3 => FinalsD3[_state],
                4 => FinalsD4[_state],
                _ => FinalsD5[_state],
            };
    }

}
